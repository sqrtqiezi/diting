# Implementation Plan: å¾®ä¿¡ API è¿é€šæ€§æµ‹è¯•

**Branch**: `001-wechat-api-connectivity` | **Date**: 2025-11-01 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-wechat-api-connectivity/spec.md`

**Note**: This template is filled in by the `/speckit.plan` command. See `.specify/templates/commands/plan.md` for the execution workflow.

## Summary

å®ç°å¾®ä¿¡ API è¿é€šæ€§æµ‹è¯•åŠŸèƒ½,éªŒè¯èšåˆæœºå™¨äººå¾®ä¿¡ API çš„è®¤è¯æœºåˆ¶ã€è¯·æ±‚æ ¼å¼å’ŒåŸºæœ¬è¿æ¥èƒ½åŠ›ã€‚é€šè¿‡è°ƒç”¨"è·å–ç™»å½•è´¦å·ä¿¡æ¯"æ¥å£æµ‹è¯•å®Œæ•´çš„ API è°ƒç”¨æµç¨‹,åŒ…æ‹¬è®¤è¯ã€è¯·æ±‚æ„å»ºã€å“åº”è§£æå’Œé”™è¯¯å¤„ç†ã€‚è¿™æ˜¯æ‰€æœ‰åç»­å¾®ä¿¡æ•°æ®é‡‡é›†åŠŸèƒ½çš„åŸºç¡€éªŒè¯ã€‚

æŠ€æœ¯æ–¹æ¡ˆ:ä½¿ç”¨ Python 3.12 + httpx æ„å»º HTTP å®¢æˆ·ç«¯,å®ç°ç»“æ„åŒ–çš„ API è¯·æ±‚å°è£…ã€å®Œæ•´çš„é”™è¯¯åˆ†ç±»å¤„ç†å’Œè¯¦ç»†çš„è¯·æ±‚æ—¥å¿—è®°å½•ã€‚éµå¾ªéšç§ä¼˜å…ˆåŸåˆ™,å¯¹æ•æ„Ÿä¿¡æ¯(API å‡­è¯ã€ç”¨æˆ·æ•°æ®)è¿›è¡Œè„±æ•å¤„ç†ã€‚

## Technical Context

**Language/Version**: Python 3.12.6 (å·²å®‰è£…å¹¶é…ç½®è™šæ‹Ÿç¯å¢ƒ)
**Primary Dependencies**: httpx (å¼‚æ­¥ HTTP å®¢æˆ·ç«¯), pydantic (æ•°æ®éªŒè¯), structlog (ç»“æ„åŒ–æ—¥å¿—)
**Storage**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ (æ—¥å¿—æ–‡ä»¶,JSON æ ¼å¼è¯·æ±‚/å“åº”è®°å½•)
**Testing**: pytest (å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•), pytest-httpx (HTTP mock), pytest-cov (è¦†ç›–ç‡ â‰¥80%)
**Target Platform**: macOS/Linux (æœ¬åœ°å¼€å‘ç¯å¢ƒ,åç»­å¯éƒ¨ç½²åˆ°æœåŠ¡å™¨)
**Project Type**: single (å‘½ä»¤è¡Œå·¥å…· + Python åº“)
**Performance Goals**: API è°ƒç”¨å“åº”æ—¶é—´ < 3ç§’, æ—¥å¿—è®°å½•å»¶è¿Ÿ < 100ms
**Constraints**:
- API è°ƒç”¨é¢‘ç‡é™åˆ¶: â‰¤ 100æ¬¡/åˆ†é’Ÿ (èšåˆæœºå™¨äººå¹³å°é™åˆ¶)
- è¶…æ—¶è®¾ç½®: 10ç§’è¿æ¥è¶…æ—¶, 30ç§’è¯»å–è¶…æ—¶
- å†…å­˜å ç”¨: < 100MB (å•æ¬¡ API è°ƒç”¨)
- æ•æ„Ÿä¿¡æ¯è„±æ•: API å‡­è¯å’Œç”¨æˆ·æ•°æ®å¿…é¡»è„±æ•åè®°å½•æ—¥å¿—
**Scale/Scope**:
- åˆæœŸ: å•è®¾å¤‡æµ‹è¯• (1ä¸ªå¾®ä¿¡å®ä¾‹)
- ä»£ç è§„æ¨¡: ~500 LOC (æ ¸å¿ƒ API å®¢æˆ·ç«¯)
- æµ‹è¯•ç”¨ä¾‹: ~20 ä¸ª (è¦†ç›–æ­£å¸¸æµç¨‹ + 5ç§é”™è¯¯åœºæ™¯)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Privacy First (NON-NEGOTIABLE) - âœ… PASS

**åˆè§„æ€§è¯„ä¼°**:
- âœ… **æœ¬åœ°ä¼˜å…ˆ**: API å‡­è¯å­˜å‚¨åœ¨æœ¬åœ°é…ç½®æ–‡ä»¶,ä¸ä¸Šä¼ äº‘ç«¯
- âœ… **æ•æ„Ÿä¿¡æ¯è„±æ•**: æ—¥å¿—è®°å½•ä¸­ app_secret æ˜¾ç¤ºå‰ 4 ä½ + `***`, ç”¨æˆ·æ•°æ®(å¾®ä¿¡å·/æ˜µç§°)å“ˆå¸ŒåŒ–
- âœ… **æœ€å°æƒé™**: ä»…è¯·æ±‚"è·å–ç™»å½•è´¦å·ä¿¡æ¯"æƒé™,ä¸è¯·æ±‚æ¶ˆæ¯/è”ç³»äººç­‰æ•æ„Ÿæ•°æ®
- âœ… **å®¡è®¡æ—¥å¿—**: æ‰€æœ‰ API è°ƒç”¨è®°å½•åˆ°ç»“æ„åŒ–æ—¥å¿—,åŒ…å«æ—¶é—´æˆ³å’Œè„±æ•å‚æ•°
- âš ï¸  **åŠ å¯†å­˜å‚¨**: åˆæœŸä½¿ç”¨æ˜æ–‡é…ç½®æ–‡ä»¶å­˜å‚¨å‡­è¯(å¼€å‘é˜¶æ®µå¯æ¥å—),Phase 2 éœ€æ”¹ç”¨æ“ä½œç³»ç»Ÿå¯†é’¥é“¾

**é£é™©**: å¼€å‘é˜¶æ®µ API å‡­è¯æ˜æ–‡å­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­
**ç¼“è§£**: 1) é…ç½®æ–‡ä»¶åŠ å…¥ .gitignore 2) æ–‡æ¡£è¯´æ˜å®‰å…¨å­˜å‚¨æœ€ä½³å®è·µ 3) Phase 2 å®ç°å¯†é’¥é“¾é›†æˆ

### II. Endpoint Modularity (NON-NEGOTIABLE) - âœ… PASS

**åˆè§„æ€§è¯„ä¼°**:
- âœ… **ç‹¬ç«‹éƒ¨ç½²**: å¾®ä¿¡ç«¯ç‚¹é€‚é…å™¨ä½œä¸ºç‹¬ç«‹æ¨¡å— `src/diting/endpoints/wechat/`
- âœ… **ç»Ÿä¸€æ¥å£**: å®ç° `EndpointAdapter` æŠ½è±¡åŸºç±»,å®šä¹‰ `authenticate()`, `fetch_data()` æ¥å£
- âœ… **å®¹é”™éš”ç¦»**: å¾®ä¿¡ API å¤±è´¥ä¸å½±å“å…¶ä»–ç«¯ç‚¹(é£ä¹¦/é‚®ç®±)æˆ–æ ¸å¿ƒç³»ç»Ÿ
- âœ… **å¯æ‰©å±•æ€§**: æ–°å¢é£ä¹¦/é‚®ç®±ç«¯ç‚¹åªéœ€å®ç°ç›¸åŒæ¥å£,æ— éœ€ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
- âœ… **æ’ä»¶åŒ–**: ç«¯ç‚¹é€‚é…å™¨é€šè¿‡é…ç½®æ–‡ä»¶å¯ç”¨/ç¦ç”¨

**è®¾è®¡å†³ç­–**: é‡‡ç”¨ç«¯ç‚¹é€‚é…å™¨æ¨¡å¼ (Adapter Pattern),æ¯ä¸ªæ•°æ®æºç‹¬ç«‹æ¨¡å—

### III. Knowledge Graph Core - âš ï¸ PARTIAL (æœ¬åŠŸèƒ½æš‚ä¸æ¶‰åŠ)

**åˆè§„æ€§è¯„ä¼°**:
- N/A: æœ¬åŠŸèƒ½æ˜¯è¿é€šæ€§æµ‹è¯•,ä¸æ¶‰åŠçŸ¥è¯†å›¾è°±æ„å»º
- âœ… **æ—¶é—´ç»´åº¦**: API è°ƒç”¨æ—¥å¿—ä¿ç•™æ—¶é—´æˆ³,ä¸ºåç»­æ—¶é—´çº¿åˆ†æåšå‡†å¤‡
- ğŸ“‹ **åç»­è®¡åˆ’**: Feature 003 å°†å®ç°å®ä½“æå–(ä»å¾®ä¿¡æ¶ˆæ¯æå–äººç‰©/äº‹ä»¶)

**ç»“è®º**: æœ¬åŠŸèƒ½ä¸“æ³¨äºåŸºç¡€è¿æ¥,ä¸è¿åçŸ¥è¯†å›¾è°±åŸåˆ™

### IV. LLM-Powered Insights - âš ï¸ PARTIAL (æœ¬åŠŸèƒ½æš‚ä¸æ¶‰åŠ)

**åˆè§„æ€§è¯„ä¼°**:
- N/A: æœ¬åŠŸèƒ½ä¸æ¶‰åŠ LLM åˆ†æ
- ğŸ“‹ **åç»­è®¡åˆ’**: Feature 004 å°†å®ç°åŸºäºå¾®ä¿¡æ•°æ®çš„ LLM æ´å¯Ÿç”Ÿæˆ

**ç»“è®º**: æœ¬åŠŸèƒ½æ˜¯æ•°æ®é‡‡é›†åŸºç¡€,ä¸è¿å LLM åŸåˆ™

### V. Observability & Testability - âœ… PASS

**åˆè§„æ€§è¯„ä¼°**:
- âœ… **ç»“æ„åŒ–æ—¥å¿—**: ä½¿ç”¨ structlog è¾“å‡º JSON æ ¼å¼æ—¥å¿—,åŒ…å« request_id, timestamp, level
- âœ… **æ€§èƒ½ç›‘æ§**: è®°å½•æ¯æ¬¡ API è°ƒç”¨çš„å“åº”æ—¶é—´å’ŒçŠ¶æ€ç 
- âœ… **é”™è¯¯è¿½è¸ª**: è¯¦ç»†è®°å½•é”™è¯¯ç±»å‹ã€å †æ ˆä¿¡æ¯å’Œä¸Šä¸‹æ–‡(è¯·æ±‚å‚æ•°/å“åº”å†…å®¹)
- âœ… **æµ‹è¯•è¦†ç›–**: ç›®æ ‡è¦†ç›–ç‡ â‰¥80%
  - å•å…ƒæµ‹è¯•: API è¯·æ±‚æ„å»ºã€å“åº”è§£æã€é”™è¯¯åˆ†ç±»
  - é›†æˆæµ‹è¯•: çœŸå® API è°ƒç”¨(ä½¿ç”¨æµ‹è¯•å‡­è¯)
  - å¥‘çº¦æµ‹è¯•: éªŒè¯ API å“åº”æ ¼å¼ç¬¦åˆæ–‡æ¡£è§„èŒƒ
- âœ… **æœ¬åœ°è°ƒè¯•**: æ”¯æŒç¦»çº¿å¼€å‘,ä½¿ç”¨ pytest-httpx mock HTTP è¯·æ±‚
- âœ… **æ•°æ®æ¨¡æ‹Ÿ**: æä¾›è„±æ•çš„æµ‹è¯•æ•°æ®é›†(ç¤ºä¾‹ API å“åº”)

**æµ‹è¯•ç­–ç•¥**:
1. Mock æµ‹è¯•: ä½¿ç”¨ pytest-httpx æ¨¡æ‹Ÿ API å“åº”(æˆåŠŸ/å¤±è´¥åœºæ™¯)
2. é›†æˆæµ‹è¯•: ä½¿ç”¨æµ‹è¯•å‡­è¯è°ƒç”¨çœŸå® API (æ‰‹åŠ¨è§¦å‘,ä¸å½±å“ CI)
3. å¥‘çº¦æµ‹è¯•: ä½¿ç”¨ JSON Schema éªŒè¯å“åº”æ ¼å¼

### ğŸš¦ Gate Status: **PASS** (å…è®¸è¿›å…¥ Phase 0)

**æ€»ç»“**: æœ¬åŠŸèƒ½ç¬¦åˆå®ªç« çš„ 3ä¸ªå…³é”®åŸåˆ™ (I, II, V),å¦å¤– 2 ä¸ªåŸåˆ™ (III, IV) ä¸é€‚ç”¨äºè¿é€šæ€§æµ‹è¯•åœºæ™¯ã€‚è¯†åˆ«åˆ° 1 ä¸ªé£é™©(æ˜æ–‡å­˜å‚¨å‡­è¯)å·²æœ‰ç¼“è§£æªæ–½ã€‚

---

## Constitution Re-check (Phase 1 å®Œæˆå)

**Date**: 2025-11-01
**Status**: âœ… **PASS** - è®¾è®¡æ–¹æ¡ˆç¬¦åˆå®ªç« è¦æ±‚

### è®¾è®¡è¯„å®¡ç»“æœ

ç»è¿‡ Phase 0 (Research) å’Œ Phase 1 (Design) å,é‡æ–°è¯„ä¼°å®ªç« åˆè§„æ€§:

#### I. Privacy First - âœ… PASS (å¼ºåŒ–)

**è®¾è®¡æ”¹è¿›**:
- âœ… **æ•æ„Ÿæ•°æ®è„±æ•**: å®ç° `structlog` å¤„ç†å™¨ `mask_sensitive_data()`,è‡ªåŠ¨è„±æ•æ‰€æœ‰æ—¥å¿—
  - `app_secret`: æ˜¾ç¤ºå‰ 4 ä½ + `***`
  - ç”¨æˆ·æ•°æ®: SHA-256 å“ˆå¸Œå‰ 8 ä½
- âœ… **é…ç½®å®‰å…¨**:
  - `config/wechat.yaml` åŠ å…¥ `.gitignore`
  - æä¾› `config/wechat.yaml.example` æ¨¡æ¿
  - quickstart.md æ˜ç¡®è¯´æ˜å®‰å…¨å­˜å‚¨æœ€ä½³å®è·µ
- âœ… **å®¡è®¡æ—¥å¿—**: æ‰€æœ‰ API è°ƒç”¨è®°å½•åˆ° `RequestLog` æ¨¡å‹,åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡

**é£é™©ç¼“è§£**: Phase 2 å°†å®ç°æ“ä½œç³»ç»Ÿå¯†é’¥é“¾é›†æˆ(å·²åœ¨ data-model.md ä¸­è§„åˆ’)

#### II. Endpoint Modularity - âœ… PASS (æ¶æ„ç¡®è®¤)

**è®¾è®¡æ¶æ„**:
- âœ… **æŠ½è±¡åŸºç±»**: `src/diting/endpoints/base.py` å®šä¹‰ `EndpointAdapter` æ¥å£
- âœ… **ç‹¬ç«‹æ¨¡å—**: `src/diting/endpoints/wechat/` å®Œå…¨ç‹¬ç«‹,åŒ…å« 5 ä¸ªæ–‡ä»¶:
  - `client.py`: HTTP å®¢æˆ·ç«¯
  - `models.py`: Pydantic æ•°æ®æ¨¡å‹
  - `exceptions.py`: è‡ªå®šä¹‰å¼‚å¸¸
  - `config.py`: é…ç½®åŠ è½½
  - `__init__.py`: æ¨¡å—å¯¼å‡º
- âœ… **ç»Ÿä¸€æ¥å£**: æ‰€æœ‰ç«¯ç‚¹å®ç°ç›¸åŒçš„æ–¹æ³•ç­¾å (`authenticate()`, `fetch_data()`)
- âœ… **å®¹é”™éš”ç¦»**: é”™è¯¯åˆ†ç±»ä½“ç³»(`WeChatAPIError` åŠå­ç±»)ç¡®ä¿é”™è¯¯ä¸æ‰©æ•£

**éªŒè¯**: é¡¹ç›®ç»“æ„(plan.md Â§ Project Structure)å·²æ˜ç¡®å®šä¹‰

#### III. Knowledge Graph Core - âš ï¸ N/A (æœ¬åŠŸèƒ½ä¸æ¶‰åŠ)

**ç¬¦åˆæ€§**: æœ¬åŠŸèƒ½ä¸“æ³¨äº API è¿æ¥æµ‹è¯•,ä¸æ„å»ºçŸ¥è¯†å›¾è°±,ä½†ä¸ºåç»­åŠŸèƒ½å¥ å®šåŸºç¡€:
- âœ… **æ—¶é—´æˆ³**: `RequestLog` æ¨¡å‹åŒ…å« `timestamp` å­—æ®µ
- âœ… **ç»“æ„åŒ–æ•°æ®**: ä½¿ç”¨ Pydantic æ¨¡å‹ç¡®ä¿æ•°æ®æ ¼å¼ä¸€è‡´æ€§

#### IV. LLM-Powered Insights - âš ï¸ N/A (æœ¬åŠŸèƒ½ä¸æ¶‰åŠ)

**ç¬¦åˆæ€§**: æœ¬åŠŸèƒ½ä¸æ¶‰åŠ LLM åˆ†æ

#### V. Observability & Testability - âœ… PASS (å…¨é¢å®ç°)

**è®¾è®¡å®ç°**:
- âœ… **ç»“æ„åŒ–æ—¥å¿—**:
  - ä½¿ç”¨ `structlog` + `orjson`
  - JSON æ ¼å¼è¾“å‡º
  - è‡ªåŠ¨æ·»åŠ  `request_id`, `timestamp`, `level`
- âœ… **æ€§èƒ½ç›‘æ§**: `RequestLog` è®°å½• `response_time_ms`
- âœ… **é”™è¯¯è¿½è¸ª**: è‡ªå®šä¹‰å¼‚å¸¸å±‚æ¬¡ + è¯¦ç»†é”™è¯¯ä¿¡æ¯
- âœ… **æµ‹è¯•è¦†ç›–**:
  - å•å…ƒæµ‹è¯•: `pytest-httpx` mock HTTP è¯·æ±‚
  - é›†æˆæµ‹è¯•: çœŸå® API è°ƒç”¨(æ‰‹åŠ¨è§¦å‘)
  - å¥‘çº¦æµ‹è¯•: JSON Schema éªŒè¯
  - ç›®æ ‡è¦†ç›–ç‡: â‰¥80%
- âœ… **æœ¬åœ°è°ƒè¯•**: Mock æµ‹è¯•æ”¯æŒå®Œå…¨ç¦»çº¿å¼€å‘
- âœ… **æ•°æ®æ¨¡æ‹Ÿ**: contracts/ åŒ…å«ç¤ºä¾‹æ•°æ®

**å¥‘çº¦**: 3 ä¸ª JSON Schema æ–‡ä»¶å®šä¹‰ API æ ¼å¼(api_request, api_response, user_info_response)

### ğŸ¯ æœ€ç»ˆå†³ç­–: **è®¾è®¡æ‰¹å‡†,å…è®¸è¿›å…¥ Phase 2 (Tasks ç”Ÿæˆ)**

**ç†ç”±**:
1. æ‰€æœ‰é€‚ç”¨çš„å®ªç« åŸåˆ™(I, II, V)éƒ½å·²åœ¨è®¾è®¡ä¸­å®Œå…¨ä½“ç°
2. æŠ€æœ¯é€‰å‹(httpx, structlog, Pydantic)ç»è¿‡å……åˆ†ç ”ç©¶å’Œè®ºè¯
3. æ•°æ®æ¨¡å‹æ˜ç¡®,åŒ…å« 6 ä¸ªæ ¸å¿ƒå®ä½“å’Œå®Œæ•´çš„éªŒè¯è§„åˆ™
4. API å¥‘çº¦å·²å®šä¹‰,æ”¯æŒå¥‘çº¦æµ‹è¯•
5. å¿«é€Ÿå¼€å§‹æ–‡æ¡£å®Œæ•´,å¯åœ¨ 10 åˆ†é’Ÿå†…éªŒè¯è®¾è®¡å¯è¡Œæ€§
6. è¯†åˆ«çš„é£é™©(æ˜æ–‡å‡­è¯)å·²æœ‰ç¼“è§£æªæ–½å’Œåç»­æ”¹è¿›è®¡åˆ’

**ä¸‹ä¸€æ­¥**: è¿è¡Œ `/speckit.tasks` ç”Ÿæˆå®ç°ä»»åŠ¡åˆ—è¡¨

---

## API å®¢æˆ·ç«¯å¼€å‘è§„èŒƒ

æœ¬åŠŸèƒ½ä½œä¸º Diting é¡¹ç›®çš„é¦–ä¸ª REST API å®¢æˆ·ç«¯å®ç°,éµå¾ªé¡¹ç›®çº§åˆ«çš„ **[REST API å®¢æˆ·ç«¯å¼€å‘è§„èŒƒ](../../../.specify/memory/api-client-standards.md)**ã€‚

### æ ¸å¿ƒè§„èŒƒè¦æ±‚

#### æŠ€æœ¯æ ˆ
- âœ… **HTTP å®¢æˆ·ç«¯**: httpx (å”¯ä¸€æŒ‡å®šåº“)
- âœ… **æ•°æ®éªŒè¯**: Pydantic (æ‰€æœ‰è¯·æ±‚/å“åº”)
- âœ… **æ—¥å¿—è®°å½•**: structlog (ç»“æ„åŒ– JSON æ—¥å¿—)

#### ä»£ç ç»“æ„
- âœ… **ç›®å½•**: `src/diting/endpoints/wechat/`
- âœ… **æ–‡ä»¶**: `client.py`, `models.py`, `exceptions.py`, `config.py`
- âœ… **æ¥å£**: ç»§æ‰¿ `EndpointAdapter` æŠ½è±¡åŸºç±»

#### å®‰å…¨æ€§
- âœ… **æ•æ„Ÿä¿¡æ¯è„±æ•**: app_secret æ˜¾ç¤ºå‰ 4 ä½ + `***`
- âœ… **é…ç½®å®‰å…¨**: `config/wechat.yaml` åŠ å…¥ `.gitignore`
- âœ… **å®¡è®¡æ—¥å¿—**: æ‰€æœ‰ API è°ƒç”¨è®°å½•å®Œæ•´ä¸Šä¸‹æ–‡

#### æµ‹è¯•
- âœ… **è¦†ç›–ç‡**: â‰¥80%
- âœ… **ä¸‰å±‚æµ‹è¯•**: å•å…ƒæµ‹è¯•(pytest-httpx) + é›†æˆæµ‹è¯•(çœŸå® API) + å¥‘çº¦æµ‹è¯•(JSON Schema)

#### æ€§èƒ½
- âœ… **è¶…æ—¶**: è¿æ¥ 10s, è¯»å– 30s
- âœ… **é‡è¯•**: 3 æ¬¡,æŒ‡æ•°é€€é¿,ä»…é‡è¯• 502/503/504

### è§„èŒƒç¬¦åˆæ€§æ£€æŸ¥

æœ¬å®ç°è®¡åˆ’å·²é€šè¿‡æ‰€æœ‰è§„èŒƒè¦æ±‚:

| è§„èŒƒç±»åˆ« | è¦æ±‚ | å®ç°çŠ¶æ€ |
|---------|------|---------|
| æŠ€æœ¯æ ˆ | httpx + Pydantic + structlog | âœ… å·²é‡‡ç”¨ |
| ç›®å½•ç»“æ„ | `endpoints/{service}/` 5 æ–‡ä»¶ç»“æ„ | âœ… å·²è§„åˆ’ |
| æ¥å£å®šä¹‰ | ç»§æ‰¿ `EndpointAdapter` | âœ… å·²è®¾è®¡ |
| å¼‚å¸¸å±‚æ¬¡ | è‡ªå®šä¹‰å¼‚å¸¸ç»§æ‰¿ `EndpointError` | âœ… å·²è®¾è®¡ |
| é…ç½®ç®¡ç† | YAML + Pydantic éªŒè¯ | âœ… å·²å®ç° |
| æ•æ„Ÿä¿¡æ¯è„±æ• | structlog å¤„ç†å™¨è‡ªåŠ¨è„±æ• | âœ… å·²è®¾è®¡ |
| æµ‹è¯•è¦†ç›–ç‡ | â‰¥80% | âœ… ç›®æ ‡å·²è®¾å®š |
| API å¥‘çº¦ | JSON Schema å®šä¹‰ | âœ… å·²ç”Ÿæˆ |
| æ–‡æ¡£ | quickstart.md + docstring | âœ… å·²å®Œæˆ |

**å‚è€ƒ**: å®Œæ•´è§„èŒƒè§ [.specify/memory/api-client-standards.md](../../../.specify/memory/api-client-standards.md)

---

## Project Structure

### Documentation (this feature)

```text
specs/[###-feature]/
â”œâ”€â”€ plan.md              # This file (/speckit.plan command output)
â”œâ”€â”€ research.md          # Phase 0 output (/speckit.plan command)
â”œâ”€â”€ data-model.md        # Phase 1 output (/speckit.plan command)
â”œâ”€â”€ quickstart.md        # Phase 1 output (/speckit.plan command)
â”œâ”€â”€ contracts/           # Phase 1 output (/speckit.plan command)
â””â”€â”€ tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
src/diting/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ endpoints/                    # ç«¯ç‚¹é€‚é…å™¨æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                  # EndpointAdapter æŠ½è±¡åŸºç±»
â”‚   â””â”€â”€ wechat/                  # å¾®ä¿¡ç«¯ç‚¹é€‚é…å™¨ (æœ¬åŠŸèƒ½)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ client.py            # WeChatAPIClient - HTTP å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ models.py            # Pydantic æ•°æ®æ¨¡å‹ (è¯·æ±‚/å“åº”)
â”‚       â”œâ”€â”€ exceptions.py        # è‡ªå®šä¹‰å¼‚å¸¸ç±»
â”‚       â””â”€â”€ config.py            # é…ç½®åŠ è½½å’ŒéªŒè¯
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logging.py               # ç»“æ„åŒ–æ—¥å¿—é…ç½® (structlog)
â”‚   â””â”€â”€ security.py              # æ•æ„Ÿä¿¡æ¯è„±æ•å·¥å…·
â””â”€â”€ cli/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ wechat_test.py           # å‘½ä»¤è¡Œæµ‹è¯•å·¥å…·

tests/
â”œâ”€â”€ unit/
â”‚   â””â”€â”€ endpoints/
â”‚       â””â”€â”€ wechat/
â”‚           â”œâ”€â”€ test_client.py            # API å®¢æˆ·ç«¯å•å…ƒæµ‹è¯•
â”‚           â”œâ”€â”€ test_models.py            # æ•°æ®æ¨¡å‹éªŒè¯æµ‹è¯•
â”‚           â”œâ”€â”€ test_exceptions.py        # å¼‚å¸¸å¤„ç†æµ‹è¯•
â”‚           â””â”€â”€ test_config.py            # é…ç½®åŠ è½½æµ‹è¯•
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ endpoints/
â”‚       â””â”€â”€ wechat/
â”‚           â””â”€â”€ test_api_integration.py   # çœŸå® API é›†æˆæµ‹è¯• (æ‰‹åŠ¨è§¦å‘)
â””â”€â”€ contract/
    â””â”€â”€ endpoints/
        â””â”€â”€ wechat/
            â”œâ”€â”€ test_request_schema.py    # è¯·æ±‚æ ¼å¼å¥‘çº¦æµ‹è¯•
            â””â”€â”€ test_response_schema.py   # å“åº”æ ¼å¼å¥‘çº¦æµ‹è¯•

config/                          # é…ç½®æ–‡ä»¶ç›®å½• (åŠ å…¥ .gitignore)
â””â”€â”€ wechat.yaml.example         # é…ç½®æ¨¡æ¿

logs/                            # æ—¥å¿—è¾“å‡ºç›®å½• (åŠ å…¥ .gitignore)
```

**Structure Decision**: é‡‡ç”¨ Single Project ç»“æ„,å› ä¸º Diting æ˜¯å•ä½“ Python åº”ç”¨ã€‚æŒ‰ç«¯ç‚¹æ¨¡å—åŒ–ç»„ç»‡ä»£ç ,æ¯ä¸ªæ•°æ®æº(å¾®ä¿¡/é£ä¹¦/é‚®ç®±)ä½œä¸ºç‹¬ç«‹çš„ç«¯ç‚¹é€‚é…å™¨ã€‚æœ¬åŠŸèƒ½å®ç° `endpoints/wechat/` æ¨¡å—,ä¸ºåç»­ç«¯ç‚¹å¥ å®šåŸºç¡€ã€‚

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| [e.g., 4th project] | [current need] | [why 3 projects insufficient] |
| [e.g., Repository pattern] | [specific problem] | [why direct DB access insufficient] |
